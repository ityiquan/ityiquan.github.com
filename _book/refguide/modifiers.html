
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>modifiers · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="observe.html" />
    
    
    <link rel="prev" href="is-observable.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../MobX.html">
            
                <a href="../MobX.html">
            
                    
                    MobX
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    介绍
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../intro/overview.html">
            
                <a href="../intro/overview.html">
            
                    
                    MobX 要点
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../intro/concepts.html">
            
                <a href="../intro/concepts.html">
            
                    
                    概念 & 原则
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="api.html">
            
                <a href="api.html">
            
                    
                    API 概述
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="observable.html">
            
                <a href="observable.html">
            
                    
                    observable
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="observable-decorator.html">
            
                <a href="observable-decorator.html">
            
                    
                    @observable
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="computed-decorator.html">
            
                <a href="computed-decorator.html">
            
                    
                    (@)computed
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="autorun.html">
            
                <a href="autorun.html">
            
                    
                    autorun
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="observer-component.html">
            
                <a href="observer-component.html">
            
                    
                    (@)observer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="action.html">
            
                <a href="action.html">
            
                    
                    action
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    Observable 类型
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="object.html">
            
                <a href="object.html">
            
                    
                    对象
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="array.html">
            
                <a href="array.html">
            
                    
                    数组
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="map.html">
            
                <a href="map.html">
            
                    
                    maps
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="boxed.html">
            
                <a href="boxed.html">
            
                    
                    boxed values
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../best/react.html">
            
                <a href="../best/react.html">
            
                    
                    理解MobX是如何响应的
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../best/decorators.html">
            
                <a href="../best/decorators.html">
            
                    
                    如何（不）使用装饰符
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../资料.html">
            
                <a href="../资料.html">
            
                    
                    资料
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../faq/blogs.html">
            
                <a href="../faq/blogs.html">
            
                    
                    教程，视频和博客
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../faq/related.html">
            
                <a href="../faq/related.html">
            
                    
                    相关项目
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../faq/examples.html">
            
                <a href="../faq/examples.html">
            
                    
                    示例项目
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="../faq/boilerplates.html">
            
                <a href="../faq/boilerplates.html">
            
                    
                    样板
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5" data-path="../faq/faq.html">
            
                <a href="../faq/faq.html">
            
                    
                    常见问题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../注意点--技巧.html">
            
                <a href="../注意点--技巧.html">
            
                    
                    注意点 & 技巧
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../best/pitfalls.html">
            
                <a href="../best/pitfalls.html">
            
                    
                    常见问题 & 最佳事件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../best/store.html">
            
                <a href="../best/store.html">
            
                    
                    定义 stores
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../best/actions.html">
            
                <a href="../best/actions.html">
            
                    
                    创建（异步）actions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="../best/react-performance.html">
            
                <a href="../best/react-performance.html">
            
                    
                    优化 React 组件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.5" data-path="../best/devtools.html">
            
                <a href="../best/devtools.html">
            
                    
                    开发者工具
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.6" data-path="../best/syntax.html">
            
                <a href="../best/syntax.html">
            
                    
                    ES5 \/ ES6 \/ TypeScript 语法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.7" data-path="../best/stateless-HMR.html">
            
                <a href="../best/stateless-HMR.html">
            
                    
                    无状态组件和热加载
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" >
            
                <span>
            
                    
                    实用方法
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="autorun-async.html">
            
                <a href="autorun-async.html">
            
                    
                    autorunAsync
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="extending.html">
            
                <a href="extending.html">
            
                    
                    Atom & Reaction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="create-transformer.html">
            
                <a href="create-transformer.html">
            
                    
                    createTransformer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4" data-path="expr.html">
            
                <a href="expr.html">
            
                    
                    expr
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.5" data-path="extend-observable.html">
            
                <a href="extend-observable.html">
            
                    
                    extendObservable
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.6" data-path="is-observable.html">
            
                <a href="is-observable.html">
            
                    
                    isObservable
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.10.7" data-path="modifiers.html">
            
                <a href="modifiers.html">
            
                    
                    modifiers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8" data-path="observe.html">
            
                <a href="observe.html">
            
                    
                    intercept & observe
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.9" data-path="reaction.html">
            
                <a href="reaction.html">
            
                    
                    reaction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.10" data-path="spy.html">
            
                <a href="spy.html">
            
                    
                    spy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.11" data-path="tojson.html">
            
                <a href="tojson.html">
            
                    
                    toJS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.12" data-path="transaction.html">
            
                <a href="transaction.html">
            
                    
                    transaction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.13" data-path="untracked.html">
            
                <a href="untracked.html">
            
                    
                    untracked
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.14" data-path="when.html">
            
                <a href="when.html">
            
                    
                    when
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >modifiers</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
                                <section class="normal markdown-section">
                                
                                <h1 id="modifiers-for-observable">Modifiers for observable</h1>
<p>By default, <code>observable</code> recursively makes all the values of <em>plain</em> objects and arrays recursively observable.
Besides that, it automatically converts functions without arguments into reactive views or derived properties.
For all other types of values just a reference is stored.
In general, this should just do what you need, but if you want you can override the default behavior using <em>modifiers</em>.
Note that modifiers are &apos;sticky&apos;, they are interpreted as being annotations.
They do not only apply to the current value, but also to all values that are assigned in the future to the same attribute.</p>
<p>Note that the attributes class instances (all objects that have a prototype) will not be made observable automatically by <code>observable</code>.
It is considered to be the responsibility of the class definition / constructor function to mark the necessary attributes of a class instance observable / computed.</p>
<h2 id="computed">computed</h2>
<p>Introduces a computed property, see <a href="http://mobxjs.github.io/mobx/refguide/computed-decorator.html" target="_blank"><code>computed</code></a></p>
<h2 id="action">action</h2>
<p>Marks a function as action, see <a href="http://mobxjs.github.io/mobx/refguide/action.html" target="_blank"><code>action</code></a></p>
<h2 id="asmap">asMap</h2>
<p>Creates a new Observable Map instead of an Observable Object. See <a href="map.html"><code>asMap</code></a></p>
<h2 id="asreference">asReference</h2>
<p>The most common modifier is <code>asReference</code>.
If this modifier is used, <code>observable</code> will not attempt to make the value observable.
Use this for example if you want to store a reference to a function, instead of creating a view based on that function.
You can also use it to prevent that plain objects or arrays are made observable automatically.</p>
<pre><code class="lang-javascript">
<span class="hljs-keyword">var</span> test = observable({
    x : <span class="hljs-number">3</span>,
    doubler: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.x*<span class="hljs-number">2</span>;
    },
    someFunc: asReference(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.x;
    })
});

<span class="hljs-built_in">console</span>.log(test.doubler); <span class="hljs-comment">// === 6</span>
<span class="hljs-built_in">console</span>.log(test.someFunc); <span class="hljs-comment">// still a function</span>
</code></pre>
<h2 id="asstructure">asStructure</h2>
<p>Can be used on non-cyclic, plain JavaScript values.
Instead of comparing old values with new values based on whether the reference has changed, values are compared using deep equality before notifying any observers.
This is useful if you are working with &apos;struct&apos; like objects like colors or coordinates and each time return fresh objects with possibly the same values.
<code>asStructure</code> can be used on reactive functions, plain objects and arrays.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> ViewPort = mobxReact.observer(React.createClass({
    displayName: <span class="hljs-string">&apos;ViewPort&apos;</span>,

    componentWillMount: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        mobx.extendObservable(<span class="hljs-keyword">this</span>, {
            screenSize: {
                width: <span class="hljs-number">0</span>,
                height: <span class="hljs-number">0</span>
            },
            minSize: {
                width: <span class="hljs-number">400</span>,
                height: <span class="hljs-number">300</span>
            },
            viewPortSize: mobx.asStructure(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">return</span> {
                    width: <span class="hljs-built_in">Math</span>.max(<span class="hljs-keyword">this</span>.screenSize.width, <span class="hljs-keyword">this</span>.minSize.width),
                    height: <span class="hljs-built_in">Math</span>.max(<span class="hljs-keyword">this</span>.screenSize.height, <span class="hljs-keyword">this</span>.minSize.height)
                }
            }
        });

        <span class="hljs-built_in">window</span>.onresize = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            mobx.transaction(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">this</span>.screenSize.width = <span class="hljs-built_in">window</span>.innerWidth;
                <span class="hljs-keyword">this</span>.screenSize.height = <span class="hljs-built_in">window</span>.innerHeight;
            });
        }.bind(<span class="hljs-keyword">this</span>);
    },

    render: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> (
            <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
                <span class="hljs-attr">width:</span> <span class="hljs-attr">this.viewPortSize.width</span>,
                <span class="hljs-attr">height:</span> <span class="hljs-attr">this.viewPortSize.height</span>
            }}&gt;</span>
                test
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
        );
    }
}));
</code></pre>
<p>In the above example, the computed method <code>viewPortSize</code> returns a fresh object on each re-computation.
So MobX considers it to have changed always. This means that each <code>resize</code> event of the browser will trigger a re-render of the
<code>ViewPort</code> component.</p>
<p>However, if the window size is smaller that the <code>minSize</code>, the resize doesn&apos;t need to influence the rendering anymore, as the computed
will return the same dimensions after each run. <code>asStructure</code> signals to MobX that observers of this computation should only be triggered
if the value returned by the computed has <em>structurally</em> changed (by default strict equality is used to determine whether observers need to be notified).
This means that a new object that is returned from <code>viewPortSize</code> won&apos;t trigger a <code>render</code> if its contents are (structurally) the same as the previous value.</p>
<p>To use the <code>asStructure</code> modifier in combination with the <code>@computed</code> decorator, use the following:</p>
<pre><code class="lang-javascript">@computed({ asStructure: <span class="hljs-literal">true</span> }) get viewPortSize() {
    <span class="hljs-keyword">return</span> {
        width: <span class="hljs-built_in">Math</span>.max(<span class="hljs-keyword">this</span>.screenSize.width, <span class="hljs-keyword">this</span>.minSize.width),
        height: <span class="hljs-built_in">Math</span>.max(<span class="hljs-keyword">this</span>.screenSize.height, <span class="hljs-keyword">this</span>.minSize.height)
    }
}
</code></pre>
<h2 id="asflat">asFlat</h2>
<p>Similar to <code>asReference</code>, except that <code>asFlat</code> does not prevent its value from becoming observable, but only the children of the value.
It can be used for example to create an observable array or object that should not automatically make its children observable.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> todos = observable(asFlat([{
    title: <span class="hljs-string">&quot;make coffee&quot;</span>,
    completed: <span class="hljs-literal">false</span>
}]));

isObservable(todos); <span class="hljs-comment">// true</span>
isObservable(todos[<span class="hljs-number">0</span>]); <span class="hljs-comment">// false</span>
isObservable(todos[<span class="hljs-number">0</span>], <span class="hljs-string">&quot;title&quot;</span>); <span class="hljs-comment">// false</span>
</code></pre>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement('script');hm.src = '//hm.baidu.com/hm.js?0e60686c12d4e8d648511070d598b4e8';var s = document.getElementsByTagName('script')[0];s.parentNode.insertBefore(hm, s);})();</script>
                                
                                </section>
                            
                        </div>
                    </div>
                
            </div>

            
                
                <a href="is-observable.html" class="navigation navigation-prev " aria-label="Previous page: isObservable">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="observe.html" class="navigation navigation-next " aria-label="Next page: intercept & observe">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"modifiers","level":"1.10.7","depth":2,"next":{"title":"intercept & observe","level":"1.10.8","depth":2,"path":"refguide/observe.md","ref":"refguide/observe.md","articles":[]},"previous":{"title":"isObservable","level":"1.10.6","depth":2,"path":"refguide/is-observable.md","ref":"refguide/is-observable.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["ba","-lunr","-search"],"pluginsConfig":{"ba":{"token":"0e60686c12d4e8d648511070d598b4e8"},"highlight":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"refguide/modifiers.md","mtime":"2017-11-22T09:21:25.000Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2017-11-22T09:22:42.879Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

